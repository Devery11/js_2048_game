!function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}var n=new(function(){var n,a;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.getInitialTable=function(){return JSON.parse(JSON.stringify(t))},this.state=this.getInitialTable(),this.status="idle",this.score=0}return n=[{key:"calculateRow",value:function(t){for(var n,a,r=t.filter(function(t){return 0!==t}),s=0;s<r.length-1;s++)r[s]===r[s+1]&&(r[s]*=2,this.score+=r[s],r[s+1]=0);return(a=r=r.filter(function(t){return t})).push.apply(a,function(t){if(Array.isArray(t))return e(t)}(n=Array(4-r.length).fill(0))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);if("Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,n)}}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r}},{key:"moveLeft",value:function(){for(var t=0;t<this.state.length;t++)this.state[t]=this.calculateRow(this.state[t])}},{key:"moveRight",value:function(){for(var t=0;t<this.state.length;t++)this.state[t]=this.calculateRow(this.state[t].reverse()).reverse()}},{key:"moveUp",value:function(){for(var t=this,e=function(e){var a=t.state.map(function(t){return t[e]});t.calculateRow(a).forEach(function(t,a){n.state[a][e]=t})},n=this,a=0;a<this.state.length;a++)e(a)}},{key:"moveDown",value:function(){for(var t=this,e=function(e){var a=t.state.map(function(t){return t[e]}).reverse();t.calculateRow(a).reverse().forEach(function(t,a){n.state[a][e]=t})},n=this,a=0;a<this.state.length;a++)e(a)}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.spawnCell(0),this.spawnCell(0),this.status="playing"}},{key:"restart",value:function(){this.state=this.getInitialTable(),this.score=0,this.start()}},{key:"spawnCell",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=this.getVoidCellIndexes();if(0!==e.length){var n=e[Math.floor(Math.random()*e.length)];Math.random()<t?this.state[n[0]][n[1]]=4:this.state[n[0]][n[1]]=2}}},{key:"getVoidCellIndexes",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var n=0;n<this.state[e].length;n++)0===this.state[e][n]&&t.push([e,n]);return t}},{key:"checkWin",value:function(){for(var t=0;t<this.state.length;t++)-1!==this.state[t].indexOf(2048)&&(this.status="win")}},{key:"checkLose",value:function(){for(var t=0;t<this.state.length;t++)for(var e=0;e<this.state[t].length-1;e++){var n=this.state[e+1][t]===this.state[e][t],a=this.state[t][e+1]===this.state[t][e];if(0===this.state[t][e]||0===this.state[t][e+1]||a||n)return}this.status="lose"}}],t(r.prototype,n),a&&t(r,a),r}()),a=document.querySelector(".button"),r=document.querySelector(".game-field").getElementsByTagName("tr"),s=document.body;function i(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){for(var t=[],e=0;e<r.length;e++){for(var n=r[e].getElementsByTagName("td"),a=[],s=0;s<n.length;s++)a.push(n[s]);t.push(a)}return t}(),e=n.getState(),a=0;a<e.length;a++)for(var s=0;s<e[a].length;s++)t[a][s].classList=["field-cell"],0!==e[a][s]?(t[a][s].textContent=e[a][s],t[a][s].classList.add("field-cell--".concat(e[a][s]))):t[a][s].textContent="";document.querySelector(".game-score").textContent=""+n.getScore()}a.addEventListener("click",function(){"idle"===n.getStatus()?(a.classList.add("restart"),a.textContent="Restart",n.start(),document.querySelector(".message-start").classList.add("hidden")):("lose"===n.getStatus()?document.querySelector(".message-lose").classList.add("hidden"):"win"===n.getStatus()&&document.querySelector(".message-win").classList.add("hidden"),n.restart()),i()}),s.addEventListener("keydown",function(t){if("playing"===n.getStatus()){var e=JSON.stringify(n.getState());switch(t.keyCode){case 37:n.moveLeft();break;case 38:n.moveUp();break;case 39:n.moveRight();break;case 40:n.moveDown()}e!==JSON.stringify(n.getState())&&(n.spawnCell(),n.checkWin(),n.checkLose(),i(),"win"===n.getStatus()?document.querySelector(".message-win").classList.remove("hidden"):"lose"===n.getStatus()&&document.querySelector(".message-lose").classList.remove("hidden"))}})}();
//# sourceMappingURL=index.1ab8280c.js.map
